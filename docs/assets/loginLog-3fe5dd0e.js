import{a9 as p,a4 as C,e as _,a8 as P,q as k,G as v,y as h,v as o,x as a,H as E,a7 as s,a2 as I}from"./index-fd81ca4d.js";import{c as T,E as m,a as F,b as z,d as $,e as U}from"./el-table-column-ca176115.js";import{b as A,c as W,a as D,E as O}from"./el-input-ed77e849.js";import{E as M}from"./el-date-picker-07cbd11f.js";import{T as B,a as S}from"./TPaginationSelect-daa2b417.js";/* empty css                   */import"./index-e015c31c.js";function N(e){return p({url:"/mall/ums-member-login-log/page",method:"post",data:e})}function K(e){return p({url:`/mall/ums-member-login-log/one/${e}`,method:"get"})}function q(e){return p({url:`/mall/ums-member-login-log/del/${e}`,method:"get"})}function G(e){return p({url:"/mall/ums-member-login-log/add",method:"post",data:e})}function H(e){return p({url:"/mall/ums-member-login-log/edit",method:"post",data:e})}const j=_({data(){return{loginLogs:[],page:{total:0,current:1,size:10},selectPage:{total:0,current:1,size:6,pagerCount:5},searchId:null,dialogFormVisible:!1,loginLog:{city:"",id:0,ip:"",province:"",userAgent:"",createTime:new Date},members:[],formLabelWidth:80}},mounted(){this.getLoginLogsPage(1),this.getMembersPage(1)},components:{"t-pagination-select":B},methods:{search(){if(this.searchId==null||this.searchId==""){alert("请输入日志编号后查询");return}K(this.searchId).then(e=>{e.data==null?this.loginLogs=[]:(this.loginLogs=[],this.loginLogs.push(e.data.help))}).catch(e=>{console.log(e)})},research(){this.searchId=null,this.getLoginLogsPage(1)},toEdit(e){this.dialogFormVisible=!0,this.loginLog=T(e)},getMembersPage(e){S({current:e,size:6}).then(i=>{const d=i.data.page;this.members=d.records,this.selectPage=d}).catch(i=>{console.log(i)})},pageChange(e){this.getMembersPage(e)},getLoginLogsPage(e){N({current:e,size:10}).then(i=>{console.log(i);const d=i.data.page;this.loginLogs=d.records,this.page=d}).catch(i=>{console.log(i)})},currentchange(e){this.getLoginLogsPage(e),this.page.current=e},del(e){confirm("是否删除")==!0&&console.log(e),console.log(e),q(e).then(l=>{if(l.success)this.getLoginLogsPage(this.page.current);else return!1}).catch(l=>{})},toAdd(){this.dialogFormVisible=!0,this.loginLog={city:"",id:0,ip:"",province:"",userAgent:"",createTime:new Date}},save(){const e=this.loginLog;e.id==0?G(e).then(l=>{if(l.success)this.dialogFormVisible=!1,this.getLoginLogsPage(this.page.current),m(l.msg);else return m(l.msg),!1}).catch(l=>{m("网络错误联系管理员")}):H(e).then(l=>{if(l.success)this.dialogFormVisible=!1,this.getLoginLogsPage(this.page.current),m(l.msg);else return m(l.msg),!1}).catch(l=>{m("网络错误联系管理员")})}}}),J={style:{"margin-top":"10px"}},Q={style:{width:"95%",margin:"0 auto"}},R={class:"block"},X={class:"dialog-footer"};function Y(e,l,i,d,Z,x){const u=D,r=A,g=W,n=U,c=F,b=z,f=P("t-pagination-select"),L=M,w=O,V=$;return k(),v(E,null,[h("div",J,[h("div",Q,[o(r,{label:"日志编号","label-width":80,style:{display:"inline-flex","margin-right":"10px"}},{default:a(()=>[o(u,{modelValue:e.searchId,"onUpdate:modelValue":l[0]||(l[0]=t=>e.searchId=t),placeholder:"请输入日志编号"},null,8,["modelValue"])]),_:1}),o(g,{type:"primary",onClick:e.search},{default:a(()=>[s("查询")]),_:1},8,["onClick"]),o(g,{type:"info",onClick:e.research},{default:a(()=>[s("重置")]),_:1},8,["onClick"]),o(g,{type:"success",onClick:e.toAdd},{default:a(()=>[s("添加 ")]),_:1},8,["onClick"])]),o(c,{data:e.loginLogs,style:{width:"95%",margin:"0 auto"}},{default:a(()=>[o(n,{prop:"id",label:"编号",width:"80"}),o(n,{prop:"memberId",label:"会员编号",width:"120"}),o(n,{prop:"province",label:"省",width:"120"}),o(n,{prop:"city",label:"城市",width:"120"}),o(n,{prop:"ip",label:"IP地址",width:"120"}),o(n,{prop:"userAgent",label:"用户代理",width:"120"}),o(n,{label:"创建时间",width:"120"},{default:a(t=>[s(I(t.row.createTime!=null?t.row.createTime.replace("T"," ").slice(0,19):""),1)]),_:1}),o(n,{fixed:"right",label:"功能管理",width:"140"},{default:a(t=>[o(g,{type:"warning",size:"small",link:"",onClick:y=>e.toEdit(t.row)},{default:a(()=>[s("更新")]),_:2},1032,["onClick"]),o(g,{type:"danger",link:"",size:"small",onClick:y=>e.del(t.row.id)},{default:a(()=>[s("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),o(b,{layout:"prev, pager, next","page-size":e.page.size,total:e.page.total,style:{width:"95%",margin:"0 auto"},onCurrentChange:e.currentchange},null,8,["page-size","total","onCurrentChange"])]),o(V,{modelValue:e.dialogFormVisible,"onUpdate:modelValue":l[8]||(l[8]=t=>e.dialogFormVisible=t),title:"日志编辑"},{footer:a(()=>[h("span",X,[o(g,{onClick:l[7]||(l[7]=t=>e.dialogFormVisible=!1)},{default:a(()=>[s("取消")]),_:1}),o(g,{type:"primary",onClick:e.save},{default:a(()=>[s("保存 ")]),_:1},8,["onClick"])])]),default:a(()=>[o(w,{model:e.loginLog},{default:a(()=>[o(r,{label:"所属会员","label-width":e.formLabelWidth},{default:a(()=>[o(f,{onPageChange:e.pageChange,optionSource:e.members,modelValue:e.loginLog.memberId,"onUpdate:modelValue":l[1]||(l[1]=t=>e.loginLog.memberId=t),labelKey:"username",valueKey:"id",style:{width:"90%"},placeholder:"请选择所属会员",paginationOption:e.selectPage},null,8,["onPageChange","optionSource","modelValue","paginationOption"])]),_:1},8,["label-width"]),o(r,{label:"省","label-width":e.formLabelWidth},{default:a(()=>[o(u,{modelValue:e.loginLog.province,"onUpdate:modelValue":l[2]||(l[2]=t=>e.loginLog.province=t),placeholder:"请输入省",style:{width:"80%"}},null,8,["modelValue"])]),_:1},8,["label-width"]),o(r,{label:"城市","label-width":e.formLabelWidth},{default:a(()=>[o(u,{modelValue:e.loginLog.city,"onUpdate:modelValue":l[3]||(l[3]=t=>e.loginLog.city=t),placeholder:"请输入城市",style:{width:"80%"}},null,8,["modelValue"])]),_:1},8,["label-width"]),o(r,{label:"IP地址","label-width":e.formLabelWidth},{default:a(()=>[o(u,{modelValue:e.loginLog.ip,"onUpdate:modelValue":l[4]||(l[4]=t=>e.loginLog.ip=t),placeholder:"IP地址",style:{width:"80%"}},null,8,["modelValue"])]),_:1},8,["label-width"]),o(r,{label:"用户类型","label-width":e.formLabelWidth},{default:a(()=>[o(u,{modelValue:e.loginLog.userAgent,"onUpdate:modelValue":l[5]||(l[5]=t=>e.loginLog.userAgent=t),placeholder:"请输入用户类型",style:{width:"80%"}},null,8,["modelValue"])]),_:1},8,["label-width"]),o(r,{label:"创建时间","label-width":e.formLabelWidth},{default:a(()=>[h("div",R,[o(L,{modelValue:e.loginLog.createTime,"onUpdate:modelValue":l[6]||(l[6]=t=>e.loginLog.createTime=t),type:"datetime",placeholder:"请选择创建时间"},null,8,["modelValue"])])]),_:1},8,["label-width"])]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}const se=C(j,[["render",Y],["__scopeId","data-v-739204c3"]]);export{se as default};
